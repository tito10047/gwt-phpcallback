Package to automatic rpc callback to php with code generator.
Really simple to use, inspired by GWTcallback and extends by [gwtphprpc](http://code.google.com/p/gwtphprpc/).Use custom object, throws, primitive type, arrays created in Java, generate php code.


# What Is PhpRpc Callback #
PhpRpc Callback is a simple package to manage connection with php server.

Tested on GWT 2.0.0, 2.3.0, 2.5.1, **2.6.0**

# Example #
## Java ##
### Initialization gwt.xml ###
Import module
```
<inherits name='com.mostka.phprpc.PhpRpc'/>
```
Set server path
```
<set-configuration-property name="serverPath" value="./server" />
<set-configuration-property name="phpIndexFile" value="jsonphprpc.config.php" />
```
### Simple Object data ###

```
@PhpRpcRelocatePath("objects")
public class TestObject extends PhpRpcObject {

	public String[] aaa = {"ss","dd"};
	public int[] bbb = new int[2];
	public double[] ccc = {2,5,6,4};
	public char[] ddd = new char[2];
	public long[] eee = new long[2];
	public byte[] fff = new byte[2];
	public short[] ggg ;
	public boolean[] hhh = new boolean[2];
	public TestObject[] object = {null, null};
	public TestObject2[] object2 = {null, new TestObject2()};
	public String iii = "super";
	/*public double ddouble = 0.5;*/
	
	
}
```
### Simple Service ###
```
@PhpRpcRelocatePath("services")
public class TestService implements PhpRpcService{
	public void getTestObjectString(String arg1, int arg2, TestObject objTest, 
			PhpRpcCallback<String> p_callBack){};
	public void getTestObject(TestObject objTest, PhpRpcCallback<TestObject> p_callBack){};
}
```
### Simple use in Client ###
```
	public void onModuleLoad() {
		TestService service = GWT.create(TestService.class);
		TestObject obj = PhpRpc.create(TestObject.class);
		TestObject obj2 = PhpRpc.create(TestObject.class);
		obj2.aaa[0]="obj2";
		obj.object= obj2;
		
		PhpRpcCallback<TestObject> callback = new PhpRpcCallback<TestObject>() {
			public void onFailure(Throwable caught) {
				Window.alert(caught.getMessage());
			}
			public void onSuccess(TestObject result) {
				// TODO do somethings with result from php
			}
			public void onThrowable(PhpRpcException rpcException) {
				Window.alert(rpcException.getExceptionJs().getMessage());
			}
		};
		service.getTestObject("string", 15, obj,	callback);
	}
```
## PHP ##
### Object Data (Generated by Java) ###
```
class TestObject extends GwtRpcObjectABS{

    protected $OBJECTS_VARS_METADATA=array("String[]","int[]","double[]","char[]","long[]","byte[]","short[]",
			"boolean[]","objects/TestObject[]","objects/TestObject2[]","String");

    public $aaa = array("ss","dd");                         /*java.lang.String[]*/
    public $bbb = array(0,0);                               /*int[]*/
    public $ccc = array(2.0,5.0,6.0,4.0);                   /*double[]*/
    public $ddd = array(0,0);                             /*char[]*/
    public $eee = array(0,0);                               /*long[]*/
    public $fff = array(0,0);                               /*byte[]*/
    public $ggg = null;                                     /*short[]*/
    public $hhh = array(false,false);                       /*boolean[]*/
    public $object = array(null,null);                      /*com.mostka.phprpclibtest.client.TestObject[]*/
    public $object2 = array(null,null);                     /*com.mostka.phprpclibtest.client.TestObject2[]*/
    public $iii = "super";                                  /*java.lang.String*/

    function __construct(){
        $this->object2[1] = autoloadclass( "objects/TestObject2" );
    }
}
```
### Sevice implementation (Generated by Java) ###
```
class TestServiceImpl{
    public $ARGUMENTS_getTestObject="String|int|objects/TestObject";
    public function getTestObjectString($arg1, $arg2, TestObject $objTest){
        if (objTest==null) return new RpcException("Undefied object");
        return ("Returned from PhpCallback".$objTest->iii);
    }
    public $ARGUMENTS_getTestObjectMesage="String|objects/TestObject";
    public function getTestObject( TestObject $objTest){
        if (objTest==null) return new RpcException("Undefied object");
        $objTest->iii = "Generated inside PHP";
        return ($objTest);
    }
}
```
### index.php ###
```
    include_once "./jsonrpcphp/jsonRPCServer.php";

    jsonRPCServer::process();
```

# How is work #
GWT Object is converted to JSONstring and compressed.

In this example like :
```
{"A":"0", "B":"0", "C":["string","15",{"a":["ss","dd"], "b":[0,0], "c":[2,5,6,4], "d":[0,0], "e":[0,0],
 "f":[0,0], "h":["false","false"], "i":[null,null], "j":[null,null], "k":"nie super"}], "D":0}
```

In php server is parsed by jsonRPCServer::process(); . This static method automatic parse JSON back to Object and calling requested method with parameters. Parameters is checking by declaring type;
